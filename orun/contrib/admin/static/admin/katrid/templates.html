<templates>
  <script id="view.card" type="text/ng-template">
    <div id="katrid-action-view" class="data-form">
      <ng-include src="'view.toolbar'"></ng-include>
      <div class="content-scroll">
        <div class="content no-padding">
          <div class="data-panel col-12">

              <div class="card-view kanban" ng-if="groupings.length" card-draggable=".card-group" card-group>

                <div ng-repeat="group in groupings" class="card-group sortable-item" data-id="{{group._paramValue}}" data-group-name="{{group._paramName}}">
                  <div class="card-header margin-bottom-8">
                    <div class="pull-right">
                      <button class="btn" ng-click="cardShowAddGroupItemDlg = true"><i class="fa fa-plus"></i></button>
                    </div>
                    <h4 ng-bind="group.__str__"></h4>
                    <div class="clearfix"></div>

                    <form id="card-add-group-item-dlg" ng-submit="cardAddItem($event, cardNewName)" ng-if="cardShowAddGroupItemDlg">
                      <div class="form-group">
                        <input ng-model="cardNewName" ng-init="cardNewName = ''" class="form-control" ng-esc="cardHideAddGroupItemDlg($event)" placeholder="{{ ::gettext('Add') }}" ng-blur="cardHideAddGroupItemDlg($event)">
                      </div>
                      <button type="submit" class="btn btn-primary" onmousedown="event.preventDefault();event.stopPropagation();">${Katrid.i18n.gettext('Add')}</button>
                      <button class="btn btn-default">{{ ::gettext('Cancel') }}</button>
                    </form>

                  </div>
                  <div class="card-items" card-draggable=".card-items" card-item>
                    <div ng-repeat="record in group.records" class="card-item sortable-item ui-sortable-handle" ng-click="action.listRowClick($index, record, $event)">
                      %(content)s
                    </div>
                  </div>
                </div>

                <div class="card-add-group" title="{{ ::gettext('Click here to add new column') }}" ng-click="cardNewName='';cardShowAddGroupDlg($event);" data-group-name="{{groupings[0]._paramName}}">
                  <div ng-hide="cardAddGroupDlg">
                    <i class="fa fa-fw fa-chevron-right fa-2x"></i>
                    <div class="clearfix"></div>
                    <span class="title">{{ ::gettext('Add New Column') }}</span>
                  </div>
                  <form ng-show="cardAddGroupDlg" ng-submit="cardAddGroup($event, cardNewName)">
                  <div class="form-group">
                    <input class="form-control" ng-blur="cardAddGroupDlg=false" ng-esc="cardAddGroupDlg=false" placeholder="{{ ::gettext('Add') }}" ng-model="cardNewName">
                  </div>
                    <button type="submit" class="btn btn-primary">{{ ::gettext('Add') }}</button>
                    <button type="button" class="btn btn-default">{{ ::gettext('Cancel') }}</button>
                  </form>
                </div>
              </div>
              <div class="card-view card-deck" ng-if="!groupings.length">
                <div ng-repeat="record in records" class="card panel-default card-item card-link" ng-click="action.listRowClick($index, record, $event)">
                %(content)s
                </div>
                <div class="card-item card-ghost"></div>
                <div class="card-item card-ghost"></div>
                <div class="card-item card-ghost"></div>
                <div class="card-item card-ghost"></div>
                <div class="card-item card-ghost"></div>
                <div class="card-item card-ghost"></div>
                <div class="card-item card-ghost"></div>
                <div class="card-item card-ghost"></div>
                <div class="card-item card-ghost"></div>
                <div class="card-item card-ghost"></div>
                <div class="card-item card-ghost"></div>
              </div>

            </div>
          </div>
      </div>
    </div>
  </script>
</templates>

<templates>
  <script id="client.ChangePassword" type="text/ng-template">
    <div class="modal fade" tabindex="-1" role="dialog">
      <div class="modal-dialog">
        <form change-password-view class="modal-content" ng-submit="submit(oldPassword, newPassword, confirmPassword)">
          <div class="modal-header">
            <div class="modal-title">
              <h5>
                {{ ::_.gettext('Change Password') }}
              </h5>
            </div>
            <button class="close" type="button" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times</span>
            </button>
          </div>
          <div class="modal-body">
            <table class="table table-no-border">
              <tr>
                <td>
                  <label for="id-old-password">{{ ::_.gettext('Old Password') }}</label>
                </td>
                <td>
                  <input id="id-old-password" type="password" class="form-control" ng-model="oldPassword" autofocus required/>
                </td>
              </tr>
              <tr>
                <td>
                  <label for="id-new-password">{{ ::_.gettext('New Password') }}</label>
                </td>
                <td>
                  <input id="id-new-password" type="password" class="form-control" ng-model="newPassword" required/>
                </td>
              </tr>
              <tr>
                <td>
                  <label for="id-confirm-password">{{ ::_.gettext('Confirm New Password') }}</label>
                </td>
                <td>
                  <input id="id-confirm-password" type="password" class="form-control" ng-model="confirmPassword" required/>
                </td>
              </tr>
            </table>
          </div>
          <div class="modal-footer">
            <button class="btn btn-primary" type="submit">{{ ::_.gettext('Change Password') }}</button>
            <button class="btn btn-secondary" type="button" data-dismiss="modal">{{ ::_.gettext('Cancel') }}</button>
          </div>
        </form>
      </div>
    </div>
  </script>
</templates>
<templates>
  <script id="dialog.base" type="text/ng-template">
    <div class="modal fade" tabindex="-1" role="dialog">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">
              {{ title }}
              {{ action.info.display_name }}
            </h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="modal-dialog-body" ng-class="{'form-data-changing': dataSource.changing}">
              %(content)s
            </div>
            <div class="clearfix"></div>
          </div>
          <div class="modal-footer">
          </div>
        </div>
      </div>
    </div>
  </script>
  <script id="dialog.window" extends="dialog.base" type="text/ng-template">
    <jquery selector="div.modal-footer" operation="append">
      <button type="button" class="btn btn-primary" type="button" ng-click="saveAndClose()"
              ng-show="dataSource.changing">{{ ::gettext('Save') }}
      </button>
      <button type="button" class="btn btn-default" type="button" data-dismiss="modal"
              ng-show="dataSource.changing">{{ ::gettext('Cancel') }}
      </button>
      <button type="button" class="btn btn-default" type="button" data-dismiss="modal"
              ng-show="!dataSource.changing">{{ :: gettext('Close') }}
      </button>
    </jquery>
  </script>
</templates>
<templates>
  <script id="view.field.StatusField" type="text/ng-template">
    <div class="status-field status-field-sm pull-right">
      <input type="hidden" ng-model="self.%(fieldName)s"/>
      <div class="steps">
        <a ng-class="{active: $parent.record.%(fieldName)s === item[0]}" ng-repeat="item in choices">
          <span ng-bind="item[1]"/>
        </a>
      </div>
    </div>
  </script>

  <script id="view.field.OneToManyField.Dialog" type="text/ng-template">
    <div class="modal fade" tabindex="-1" role="dialog">
      <div class="modal-dialog modal-lg" role="document" ng-class="{'form-data-changing': dataSource.changing, 'form-data-readonly': !dataSource.changing}">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="myModalLabel">{{ field.caption }}</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          </div>
          <div class="modal-body">
    <!-- view content -->
            <div class="clearfix"></div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" type="button" ng-click="save()" ng-show="dataSource.changing">
              {{ ::_.gettext('Save') }}
            </button>
            <button type="button" class="btn btn-default" type="button" data-dismiss="modal" ng-show="dataSource.changing">
              {{ ::_.gettext('Cancel') }}
            </button>
            <button type="button" class="btn btn-default" type="button" data-dismiss="modal" ng-show="!dataSource.changing">
              {{ ::_.gettext('Close') }}
            </button>
          </div>
        </div>
      </div>
    </div>
  </script>
  <script id="view.field.SortableField" type="text/ng-template">
    <div class="sortable-field">
      <input type="hidden" ng-model="self.%(fieldName)s"/>
      <i class="fa fa-arrows"></i>
    </div>
  </script>
</templates>
<templates>
  <script id="view.form" type="text/ng-template">
    <div ng-form="form" class="form-view data-form"
         ng-class="{'form-data-changing': dataSource.changing, 'form-data-readonly': !dataSource.changing}"
    >
      <toolbar>
        <div>
          <a href="#" onclick="event.preventDefault()" title="Add to favorite"><i class="fa star fa-star-o pull-right"></i></a>
          <!-- replace-breadcrumbs -->
          <p class="help-block">{{ ::action.info.usage }}</p>
        </div>
        <div class="toolbar">
          <button class="btn btn-primary" type="button" ng-disabled="dataSource.uploading"
                  ng-click="dataSource.save()" ng-show="dataSource.changing">
            {{ ::_.gettext('Save') }}
          </button>
          <button class="btn btn-primary" type="button" ng-disabled="dataSource.uploading"
                  ng-click="dataSource.edit()" ng-show="!dataSource.changing">
            {{ ::_.gettext('Edit') }}
          </button>
          <button class="btn btn-secondary" type="button" ng-disabled="dataSource.uploading"
                  ng-click="dataSource.insert()" ng-show="!dataSource.changing">
            {{ ::_.gettext('Create') }}
          </button>
          <button class="btn btn-secondary" type="button" ng-click="dataSource.cancel()"
                  ng-show="dataSource.changing">
            {{ ::_.gettext('Cancel') }}
          </button>

          <div class="btn-group">
            <div class="dropdown">
              <button id="attachments-button" attachments-button="" ng-show="!dataSource.inserting" type="button" class="btn btn-secondary dropdown-toggle"
                      data-toggle="dropdown" aria-haspopup="true">
                <span ng-if="!attachments.length">{{ ::_.gettext('Attachments') }} </span>
                <span ng-if="attachments.length">{{ ::_.sprintf(_.gettext('%d Attachment(s)'), attachments.length) }}</span>
                <span class="caret"></span>
              </button>
              <div class="dropdown-menu attachments-menu">
                <a class="dropdown-item position-relative" ng-repeat="attachment in attachments" href="{{ ::attachment.download_url }}">
                  {{ ::attachment.name }} <span
                      class="fa fa-trash-o remove-attachment-button" title="{{ ::_.gettext('Delete attachment') }}"
                      ng-click="$event.preventDefault();action.deleteAttachment(attachments, $index);$event.stopPropagation();"></span>
                </a>
                <div role="separator" class="dropdown-divider" ng-show="attachments.length"></div>
                <a class="dropdown-item" onclick="$(this).next().click();">
                  {{ ::_.gettext('Add...') }}
                </a>
                <input type="file" class="input-file-hidden" multiple="multiple"
                       onchange="Katrid.Services.Attachments.upload(this)"/>
              </div>
            </div>
          </div>
          <div class="btn-group">
            <div class="dropdown">
              <button type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown"
                      aria-haspopup="true">
                {{ ::_.gettext('Action') }} <span class="caret"></span>
              </button>
              <div class="dropdown-menu dropdown-menu-actions">
                <a class="dropdown-item" ng-click="action.deleteSelection(true)">
                  <i class="fa fa-fw fa-trash-o"></i> {{ ::_.gettext('Delete') }}
                </a>
                <a class="dropdown-item" ng-click="action.copy()">
                  <i class="fa fa-fw fa-files-o"></i>
                  {{ ::_.gettext('Duplicate') }}
                </a>
                <a class="dropdown-item" ng-if="$parent.record.id" ng-repeat="opt in ::copyToOpts" ng-click="action.copyTo(opt.id)">
                  <i class="fa fa-fw fa-files-o"></i>
                  {{ ::_.sprintf(_.gettext('Copy To %s'), opt.name) }}
                </a>
                <!-- replace-actions -->
              </div>
            </div>
          </div>

          <div class="pull-right">
            <div class="btn-group pagination-area">
              <span ng-show="records.length">
                {{ dataSource.recordIndex + 1 }} / {{ records.length }}
              </span>
            </div>
            <div class="btn-group" role="group">
              <button class="btn btn-secondary" type="button" ng-click="dataSource.prior('form')">
                <i class="fa fa-chevron-left"></i>
              </button>
              <button class="btn btn-secondary" type="button" ng-click="dataSource.next('form')">
                <i class="fa fa-chevron-right"></i>
              </button>
            </div>
          </div>
          <replace id="buttons"></replace>
        </div>
      </toolbar>

      <div class="content-scroll">
        <div class="content">
          <div class="clearfix"></div>
          <header class="content-container-heading">
            <div class="header-buttons">
            <!-- replace-header -->
            </div>
          </header>
          <div class="clearfix"></div>
          <div class="content container">
            <div class="card panel-default data-panel browsing"
                 ng-class="{ browsing: dataSource.browsing, editing: dataSource.changing }">
              <div class="card-body teste">
                  <a class="maximize-button" role="button" title="Maximizar" onclick="$(this).closest('div.card.data-panel').toggleClass('box-fullscreen');$(this).find('i').toggleClass('fa-compress fa-expand')">
                    <i class=" fa fa-expand"></i>
                  </a>
                  <!-- replace-content -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </script>
</templates>

<templates>
  <script id="view.import" type="text/ng-template">
    <div>
      <toolbar>
        teste
      </toolbar>
      <form>
        bla bla bla
      </form>
    </div>
  </script>
  <script extends="view.buttons" type="text/ng-template">
    <jquery operation="append">
      <button class="btn btn-default btn-import-data" ng-click="action.doAction({ type: 'ir.action.client', tag: 'import' })">
        {{ ::gettext('Import') }}
      </button>
    </jquery>
  </script>
</templates>
<templates>
  <script id="view.search" type="text/ng-template">
    <div search-view-area class="search-area">
      <div class="search-view">
        <div class="search-view-facets">
          <div class="facet-view" ng-repeat="facet in search.facets">
            <span class="facet-label" ng-bind-html="facet.caption"></span>
            <span class="facet-value" ng-bind-html="facet.templateValue"></span>
            <span class="fa fa-sm fa-remove facet-remove" ng-click="$parent.search.remove($index)"></span>
          </div>
        </div>
        <input class="search-view-input" role="search" placeholder="${ ::_.gettext('Search...') }" ng-model="search.text">
        <span
            ng-class="{'fa-search-plus': !search.viewMoreButtons, 'fa-search-minus': search.viewMoreButtons}"
            class="search-view-more fa" ng-click="search.viewMoreButtons=!search.viewMoreButtons"></span>
      </div>
      <div class="col-sm-12">
        <ul class="search-dropdown-menu search-view-menu" role="menu">
          <li ng-repeat="item in ::search.fields">
            <a ng-if="item.expandable" class="expandable" href="#" onclick="event.preventDefault();" ng-mousedown="item.expanded=!item.expanded;$event.preventDefault();$event.stopPropagation();">
              <i class="fa" ng-class="{'fa-angle-down': item.expanded, 'fa-angle-right': !item.expanded}"></i>
            </a>
            <a href="#" class="search-menu-item" ng-mousedown="$event.preventDefault();$event.stopPropagation();" ng-click="item.select();$event.preventDefault();" ng-bind-html="item.template"></a>
            <a ng-if="item.loading" class="search-menu-item"><i>{{ ::_.gettext('Loading...') }}</i></a>
            <a class="search-menu-item indent" href="#" onclick="event.preventDefault()" ng-mousedown="$parent.item.selectItem(value)" ng-bind="value[1]" ng-repeat="value in item.children"></a>
          </li>
        </ul>
      </div>
    </div>
  </script>

  <script id="view.search.buttons" type="text/ng-template">
    <div class="btn-group search-view-more-area" ng-show="search.viewMoreButtons">
      <div custom-filter class="btn-group">
        <button class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" type="button" aria-expanded="false">
          <span class="fa fa-filter"></span> {{ ::_.gettext('Filters') }} <span class="caret"></span>
        </button>
        <ng-include src="'view.search.menu'"/>
      </div>
      <div class="btn-group">
        <button class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" type="button">
          <span class="fa fa-bars"></span> {{ ::_.gettext('Group By') }} <span class="caret"></span>
        </button>
        <ul class="dropdown-menu search-view-groups-menu"></ul>
      </div>
      <button class="btn btn-secondary">
        <span class="fa fa-star"></span> {{ ::_.gettext('Favorites') }} <span class="caret"></span>
      </button>
    </div>
  </script>

  <script id="view.search.menu" type="text/ng-template">
    <div class="dropdown-menu search-view-filter-menu">
      <div>
        <div ng-repeat="group in search.filterGroups">
          <a class="dropdown-item" ng-class="{'selected': filter.selected}" ng-repeat="filter in group" ng-click="filter.toggle();$event.stopPropagation();">
            {{ filter.toString() }}
          </a>
          <div class="dropdown-divider"></div>
        </div>
      </div>
      <div ng-controller="CustomFilterController">
        <div ng-repeat="filter in customFilter">
          <a class="dropdown-item" ng-class="{'selected': filterItem.selected}" ng-click="filterItem.toggle();$event.stopPropagation();$event.preventDefault();" ng-repeat="filterItem in filter" ng-bind-html="filterItem.toString()"></a>
          <div class="dropdown-divider"></div>
        </div>
        <a class="dropdown-item dropdown-search-item" onclick="event.stopPropagation();event.preventDefault();" ng-click="customSearchExpanded=!customSearchExpanded">
          <i ng-class="{ 'fa-caret-right': !customSearchExpanded, 'fa-caret-down': customSearchExpanded }" class="fa expandable"></i>
          {{ ::_.gettext('Add Custom Filter') }}
        </a>
        <div ng-if="customSearchExpanded" onclick="event.stopPropagation();event.preventDefault();">
          <div ng-show="tempFilter.length" class="margin-bottom-8">
            <a href="#" onclick="$event.preventDefault()" class="dropdown-item" ng-repeat="filter in tempFilter" ng-bind-html="filter.toString()" title="{{ ::_.gettext('Remove item') }}"></a>
          </div>
          <div class="col-12">
            <div class="form-group">
              <select class="form-control" ng-model="fieldName" ng-change="fieldChange(action.fields[fieldName])">
                <option value=""></option>
                <option ng-repeat="field in action.fieldList|orderBy:'caption'" value="{{ field.name }}">{{ field.caption }}</option>
              </select>
            </div>
            <div class="form-group">
              <ng-include src="field.paramTemplate + '.conditions'"/>
            </div>
            <div class="form-group">
              <ng-include src="field.paramTemplate" ng-show="controlVisible"/>
            </div>
            <div class="form-group">
              <button class="btn btn-primary" type="button" ng-click="applyFilter()" ng-show="searchValue!==undefined">
                {{ ::_.gettext('Apply') }}
              </button>
              <button class="btn btn-outline-secondary" type="button" ng-click="addCondition(field, condition, searchValue);fieldName='';" ng-show="searchValue">
                {{ ::_.gettext('Add a condition') }}
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </script>
</templates>

<templates>
  <script id="view.toolbar" type="text/ng-template">
    <toolbar>
      <div class="row">
        <div class="col-sm-6">
          <ol class="breadcrumb">
            <li>{{ action.info.display_name }}</li>
          </ol>
        </div>
        <search-view class="col-md-6"/>
        <!--<p class="help-block">{{ action.info.usage }}&nbsp;</p>-->
      </div>
      <div class="toolbar row">
        <div class="col-sm-6">

          <ng-include src="'view.buttons'"></ng-include>

          <ng-include src="'view.buttons.reports'"></ng-include>

          <ng-include src="'view.buttons.actions'"></ng-include>

          <!--button class="btn btn-default" ng-click="dataSource.refresh()"><i class="fa fa-refresh"></i> ${ Katrid.i18n.gettext('Refresh') }</button-->

        </div>
        <div class="col-sm-6">
          <ng-include src="'view.search.buttons'"></ng-include>
          <div class="float-right">
            <div class="btn-group pagination-area">
              <span ng-show="action.dataSource.pendingRequest">Carregando... {{action.dataSource.pendingRequest}}</span>
              <div ng-show="!action.dataSource.pendingRequest">
                <span class="paginator">{{dataSource.offset|number}} - {{dataSource.offsetLimit|number}}</span> /
                <span class="total-pages">{{dataSource.recordCount|number}}</span>
              </div>
            </div>
            <div class="btn-group">
              <button class="btn btn-secondary" type="button" ng-click="dataSource.prevPage()">
                <i class="fa fa-chevron-left"></i>
              </button>
              <button class="btn btn-secondary" type="button" ng-click="dataSource.nextPage()">
                <i class="fa fa-chevron-right"></i>
              </button>
            </div>

            <div class="btn-group">
              <button ng-if="::action.viewModes.includes('card')" class="btn btn-secondary" type="button" ng-click="action.setViewType('card')"><i class="fa fa-th-large"></i></button>
              <button ng-if="::action.viewModes.includes('list')" class="btn btn-secondary" type="button" ng-click="action.setViewType('list')"><i class="fa fa-list"></i></button>
              <button ng-if="::action.viewModes.includes('calendar')" class="btn btn-secondary" type="button" ng-click="action.setViewType('calendar')"><i class="fa fa-calendar"></i></button>
              <button ng-if="::action.viewModes.includes('chart')" class="btn btn-secondary" type="button" ng-click="action.setViewType('chart')"><i class="fa fa-bar-chart-o"></i></button>
            </div>

          </div>
        </div>

      </div>
    </toolbar>
  </script>
  <script id="view.buttons" type="text/ng-template">
    <div class="btn-group">
      <button class="btn btn-primary" type="button" ng-click="action.createNew()">
        {{ ::_.gettext('Create') }}
      </button>
    </div>
  </script>
  <script id="view.buttons.reports" type="text/ng-template">
    <div class="btn-group" ng-show="action.selectionLength">
      <button type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true">
        {{ ::_.gettext('Print') }} <span class="caret"></span>
      </button>
      <div class="dropdown-menu">
        <a class="dropdown-item" ng-click="action.autoReport()">
          {{ ::_.gettext('Auto Report') }}
        </a>

        <a ng-repeat="bindingAction in view.toolbar.print" class="dropdown-item" data-id="{{ bindingAction.id }}" ng-click="$parent.action.doBindingAction($event)">
          {{ bindingAction.name }}
        </a>

      </div>
    </div>
  </script>
  <script id="view.buttons.actions" type="text/ng-template">
    <div class="btn-group" ng-show="action.selectionLength">
      <button type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown"
              aria-haspopup="true">
        {{ ::_.gettext('Action') }} <span class="caret"></span>
      </button>
      <div class="dropdown-menu">
        <a class="dropdown-item" ng-click="action.deleteSelection()">
          <i class="fa fa-fw fa-trash-o"></i> {{ ::_.gettext('Delete') }}
        </a>


      </div>
    </div>
  </script>
</templates>
<templates>
  <script id="dialog.exception" type="text/ng-template">
    <div class="modal fade" tabindex="-1" role="dialog">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">
              {{ title }}
            </h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="modal-dialog-body">
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" type="button" data-dismiss="modal"
                    ng-show="!dataSource.changing">{{ :: gettext('Close') }}
            </button>
          </div>
        </div>
      </div>
    </div>
  </script>
  <script id="dialog.window" extends="dialog.base" type="text/ng-template">
    <jquery selector="div.modal-footer" operation="append">
      <button type="button" class="btn btn-primary" type="button" ng-click="saveAndClose()"
              ng-show="dataSource.changing">{{ ::gettext('Save') }}
      </button>
      <button type="button" class="btn btn-default" type="button" data-dismiss="modal"
              ng-show="dataSource.changing">{{ ::gettext('Cancel') }}
      </button>
      <button type="button" class="btn btn-default" type="button" data-dismiss="modal"
              ng-show="!dataSource.changing">{{ :: gettext('Close') }}
      </button>
    </jquery>
  </script>
</templates>

<templates>

  <script id="view.list" type="text/ng-template">
    <div class="action-view list-view" ng-controller="ActionController">
      <ng-include src="'view.toolbar'"></ng-include>
      <ng-include src="'view.toolbar'"></ng-include>
      <div class="content-scroll">
        <div class="content no-padding">
          <div class="clearfix"></div>
          <header class="content-container-heading">
            <div class="header-buttons">
              <!-- replace-header -->
            </div>
          </header>
          <div class="panel-default data-panel">
            <div class="panel-body no-padding">
              <div class="dataTables_wrapper form-inline dt-bootstrap no-footer">
                %(content)s
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </script>

  <script id="view.list.th.group" type="text/ng-template">
    <th ng-show="dataSource.groups.length"></th>
  </script>

  <script id="view.list.td.group" type="text/ng-template">
    <td ng-show="dataSource.groups.length" class="group-header">
      <div ng-show="row._group">
        <span class="fa fa-fw fa-caret-right"
              ng-class="{'fa-caret-down': row._group.expanded, 'fa-caret-right': row._group.collapsed}"></span>
        {{::row._group.__str__}} ({{::row._group.count }})
      </div>
    </td>
  </script>
  <script id="view.list.th.selector" type="text/ng-template">
    <th class="list-record-selector">
      <input type="checkbox" ng-click="action.selectToggle($event.currentTarget)"
             onclick="$(this).closest('table').find('td.list-record-selector input').prop('checked', $(this).prop('checked'))">
    </th>
  </script>
  <script id="view.list.td.selector" type="text/ng-template">
    <td class="list-record-selector" onclick="event.stopPropagation();">
      <input data-id="${ record.id }" type="checkbox" ng-click="action.selectToggle($event.currentTarget)"
             onclick="if (!$(this).prop('checked')) $(this).closest('table').find('th.list-record-selector input').prop('checked', false)">
    </td>
  </script>
</templates>

<templates>

  <script id="dashboard.table.jinja2" type="text/ng-template">
    {% if attrs.caption %}
      <h6>{{ attrs.caption }}</h6>
    {% endif %}
    <table class="table table-striped table-hover">
      <thead>
      <tr>
        {% for f in fields %}
          {{ f.th() }}
        {% endfor %}
      </tr>
      </thead>

      <tbody>
      <tr ng-repeat="record in {{ attrs.source }}.data">
        {% for f in fields %}
          {{ f.td() }}
        {% endfor %}
      </tr>
      </tbody>

    </table>
    <div ng-if="{{ attrs.source }}.loading">
      <span class="fas fa-spinner fa-spin"/> {{ _.gettext('Loading...') }}
    </div>
  </script>

  <script id="dashboard.grid.jinja2" type="text/ng-template">
    {% if query %}
      {{ query }}
    {% endif %}
    {% if self.caption %}
      <h6>{{ self.caption }}</h6>
    {% endif %}
    <table class="table table-bordered table-hover">
      <thead>
      <tr {{ rowClick }}>
        {% for f in fields %}
          {{ f.th() }}
        {% endfor %}
      </tr>
      </thead>

      <tbody>
      <tr ng-repeat="record in records" ng-class="{ 'group-row': record.$group, 'grid-row': !record.$group }">
        {% for f in fields %}
          {{ f.td() }}
        {% endfor %}
      </tr>
      </tbody>
      {% if self.totals.length %}
      <tfoot>
      <tr>
        {% for f in fields %}
          {{ f.tfoot() }}
        {% endfor %}
      </tr>
      </tfoot>
      {% endif %}

    </table>
  </script>

</templates>

<templates>
  <script id="file-manager.jinja2" type="text/ng-template">
    <table class="table">
      <tr>
        <td style="width: 280px">
          <div class="list-group">
            <a class="list-group-item list-group-action" ng-show="level" ng-click="backTo(level - 1)">
              ..
            </a>
            <a class="list-group-item list-group-action" ng-repeat="item in dirs" ng-click="expand(item)">
              ${item.name}
            </a>
          </div>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <h6>${currentPath}</h6>
              </td>
              <td>
    <input type="file" style="display: none" onchange="angular.element(this).scope().uploadFile(this)"/>
                <button type="button" class="btn btn-primary" onclick="$(this).prev().trigger('click')")>Upload</button>
              </td>
            </tr>
            </table>
          </div>
          <ul>
            <li ng-repeat="item in files" title="Remover arquivo">${item.name} <i class="fas fa-trash"></i></li>
          </ul>
        </td>
      </tr>
    </table>
	</script>
</templates>

<templates>
  <script id="view.form.jinja2.old" type="text/ng-template">
    <div ng-form="form" class="form-view data-form"
         ng-class="{'form-data-changing': action.dataSource.changing, 'form-data-readonly': !action.dataSource.changing}"
    >
      <toolbar>
        <div>
          {#          <a href="#" onclick="event.preventDefault()" title="{{ _.gettext('Add to favorite') }}">#}
          {#            <i class="fa star fa-star-o pull-right"></i>#}
          {#          </a>#}
          {{ breadcrumbs }}
          <p class="help-block">${ ::action.info.usage }</p>
        </div>
        <div class="toolbar row">
          <div class="col-md-8">
            <button class="btn btn-primary" type="button" ng-disabled="action.dataSource.uploading"
                    ng-click="action.dataSource.save()" ng-show="action.dataSource.changing">
              {{ _.gettext('Save') }}
            </button>
            <button class="btn btn-primary" type="button" ng-disabled="action.dataSource.uploading"
                    ng-click="action.dataSource.edit()" ng-show="!action.dataSource.changing">
              {{ _.gettext('Edit') }}
            </button>
            <button class="btn btn-outline-secondary" type="button" ng-disabled="action.dataSource.uploading"
                    ng-click="action.dataSource.insert()" ng-show="!action.dataSource.changing">
              {{ _.gettext('Create') }}
            </button>
            <button class="btn btn-outline-secondary" type="button" ng-click="action.dataSource.cancel()"
                    ng-show="action.dataSource.changing">
              {{ _.gettext('Cancel') }}
            </button>

            <div class="btn-group">
              <div class="dropdown">
                <button id="attachments-button" attachments-button="" ng-show="!action.dataSource.inserting"
                        type="button" class="btn btn-outline-secondary dropdown-toggle"
                        data-toggle="dropdown" aria-haspopup="true">
                  <span ng-if="!attachments.length">{{ _.gettext('Attachments') }} </span>
                  <span
                      ng-if="attachments.length">${ ::_.sprintf(_.gettext('%d Attachment(s)'), attachments.length) }</span>
                  <span class="caret"></span>
                </button>
                <div class="dropdown-menu attachments-menu">
                  <a class="dropdown-item position-relative" ng-repeat="attachment in attachments"
                     href="${ ::attachment.download_url }">
                    ${ ::attachment.name } <span
                      class="fa fa-times remove-attachment-button" title="{{ _.gettext('Delete attachment') }}"
                      ng-click="$event.preventDefault();action.deleteAttachment(attachments, $index);$event.stopPropagation();"></span>
                  </a>
                  <div role="separator" class="dropdown-divider" ng-show="attachments.length"></div>
                  <a class="dropdown-item" onclick="$(this).next().click();">
                    {{ _.gettext('Add...') }}
                  </a>
                  <input type="file" class="input-file-hidden" multiple="multiple"
                         onchange="Katrid.Services.Attachments.upload(this)"/>
                </div>
              </div>
            </div>
            <div class="btn-group">
              <div class="dropdown">
                <button type="button" class="btn btn-outline-secondary dropdown-toggle" data-toggle="dropdown"
                        aria-haspopup="true">
                  {{ _.gettext('Action') }} <span class="caret"></span>
                </button>
                <div class="dropdown-menu dropdown-menu-actions">
                  <a class="dropdown-item" ng-click="action.deleteSelection(true)">
                    <i class="fa fa-fw fa-trash-o"></i> {{ _.gettext('Delete') }}
                  </a>
                  <a class="dropdown-item" ng-click="action.copy()">
                    <i class="fa fa-fw fa-files-o"></i>
                    {{ _.gettext('Duplicate') }}
                  </a>
                  <a class="dropdown-item" ng-if="$parent.record.id" ng-repeat="opt in ::copyToOpts"
                     ng-click="action.copyTo(opt.id)">
                    <i class="fa fa-fw fa-files-o"></i>
                    {{ _.sprintf(_.gettext('Copy To %s'), opt.name) }}
                  </a>
                  <!-- replace-actions -->
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="float-right">
              <div class="btn-group pagination-area">
              <span ng-show="records.length">
                ${ action.dataSource.recordIndex + 1 } / ${ records.length }
              </span>
              </div>
              <div class="btn-group" role="group">
                <button class="btn btn-outline-secondary" type="button" ng-click="action.dataSource.prior('form')">
                  <i class="fa fa-chevron-left"></i>
                </button>
                <button class="btn btn-outline-secondary" type="button" ng-click="action.dataSource.next('form')">
                  <i class="fa fa-chevron-right"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </toolbar>

  </script>

  <script id="view.form.jinja2" type="text/ng-template">
    <div ng-form="form" class="form-view data-form"
         ng-class="{'form-data-changing': action.dataSource.changing, 'form-data-readonly': !action.dataSource.changing}"
    >
      <div class="content">
        <div class="clearfix"></div>
        {% if header %}
        <header class="content-container-heading">
          <div class="header-buttons">
            {{ header }}
          </div>
        </header>
        {% endif %}
        <div class="clearfix"></div>
        <div class="page-sheet">
          <div class="content container">
            <div class="card panel-default data-panel browsing"
                 ng-class="{ browsing: action.dataSource.browsing, editing: action.dataSource.changing }">
              <div class="card-body template-placeholder">
                <a class="maximize-button" role="button" title="Maximizar"
                   onclick="$(this).closest('div.card.data-panel').toggleClass('box-fullscreen');$(this).find('i').toggleClass('fa-compress fa-expand')">
                  <i class=" fa fa-expand"></i>
                </a>
                {{ content }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </script>

  <script id="view.form.empty.jinja2" type="text/ng-template">
    <div><div class="template-placeholder"></div></div>
  </script>

  <script id="view.form.dialog.jinja2" type="text/ng-template">
    <action-view id="action1" class="modal" tabindex="-1" role="dialog">
      <div class="modal-dialog modal-lg form-view form-data-changing" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">
              {{ caption }}
            </h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                aria-hidden="true">&times;</span></button>
          </div>
          <div class="modal-body data-form data-panel ng-form"
               ng-class="{'form-data-changing': action.dataSource.changing, 'form-data-readonly': !action.dataSource.changing}">
            <div class="clearfix"></div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" type="button" ng-click="action.saveAndClose()"
                    ng-if="action.dataSource.changing">
              {{ _.gettext('Save') }}
            </button>
            <button type="button" class="btn btn-outline-secondary" type="button" data-dismiss="modal"
                    ng-if="action.dataSource.changing">
              {{ _.gettext('Cancel') }}
            </button>
            <button type="button" class="btn btn-outline-secondary" type="button" ng-click="action.delete()"
                    ng-if="action.dataSource.changing">
              {{ _.gettext('Remove') }}
            </button>
            <button type="button" class="btn btn-secondary" type="button" data-dismiss="modal"
                    ng-if="!action.dataSource.changing">
              {{ _.gettext('Close') }}
            </button>
          </div>
        </div>
      </div>
    </action-view>
  </script>

</templates>

<templates>
  <script id="view.param.String" type="text/ng-template">
    <div class="form-group">
      <input class="form-control" ng-model="searchValue" ng-change="valueChange(searchValue)">
    </div>
  </script>

  <script id="view.param.String.conditions" type="text/ng-template">
    <select class="form-control" ng-model="$parent.condition" ng-change="conditionChange(condition)">
      <option value="like">${ ::_.gettext('Contains') }</option>
      <option value="not like">${ ::_.gettext('Not contains') }</option>
      <option value="=">${ ::_.gettext('Is equal') }</option>
      <option value="!=">${ ::_.gettext('Is different') }</option>
      <option value="is not null">${ ::_.gettext('Is defined') }</option>
      <option value="is null">${ ::_.gettext('Is not defined') }</option>
    </select>
  </script>

  <script id="view.param.Integer" type="text/ng-template">
    <div class="form-group">
      <input class="form-control" type="number" step="1" placeholder="${ ::_.gettext('Field Value') }" ng-model="searchValue" ng-change="valueChange(searchValue)">
    </div>
  </script>

  <script id="view.param.Integer.conditions" type="text/ng-template">
    <select class="form-control" ng-model="$parent.condition" ng-change="conditionChange(condition)">
      <option value="=">${ ::_.gettext('Is equal') }</option>
      <option value="!=">${ ::_.gettext('Is different') }</option>
      <option value=">">${ ::_.gettext('Greater-than') }</option>
      <option value="<">${ ::_.gettext('Less-than') }</option>
      <option value="is not null">${ ::_.gettext('Is defined') }</option>
      <option value="is null">${ ::_.gettext('Is not defined') }</option>
    </select>
  </script>

  <script id="view.param.Boolean" type="text/ng-template">
    <select class="form-control text-capitalize" ng-model="searchValue" ng-change="valueChange(searchValue)">
      <option value="true">${ ::_.gettext('yes') }</option>
      <option value="false">${ ::_.gettext('no') }</option>
    </select>
  </script>
  <script id="view.param.Boolean.conditions" type="text/ng-template"></script>

  <script id="view.param.Date" type="text/ng-template">
    <div class="form-group">
      <input class="form-control" date-input type="date" ng-model="searchValue" ng-change="valueChange(searchValue)">
    </div>
  </script>
  <script id="view.param.Date.conditions" type="text/ng-template">
    <select class="form-control" ng-model="condition" ng-change="conditionChange(condition)">
      <option value="=">${ ::_.gettext('Is equal') }</option>
      <option value="!=">${ ::_.gettext('Is different') }</option>
    </select>
  </script>

  <script id="view.param.DateTime" type="text/ng-template">
    <div class="form-group">
      <input class="form-control" date-input type="date" ng-model="searchValue" ng-change="valueChange(searchValue)">
    </div>
  </script>

  <script id="view.param.DateTime.conditions" type="text/ng-template">
    <select class="form-control" ng-model="condition" ng-change="conditionChange(condition)">
      <option value="=">${ ::_.gettext('Is equal') }</option>
      <option value="!=">${ ::_.gettext('Is different') }</option>
      <option value=">">${ ::_.gettext('Greater-than') }</option>
      <option value="<">${ ::_.gettext('Less-than') }</option>
    </select>
  </script>

  <script id="view.param.ForeignKey" type="text/ng-template">
    <div class="form-group">
      <input class="form-control" ng-model="searchValue" ng-change="valueChange(searchValue)" fk-autocomplete="field" model-name="${ $parent.action.model.name }" field="${ fieldName }">
    </div>
  </script>

  <script id="view.param.ForeignKey.conditions" type="text/ng-template">
    <select class="form-control" ng-model="condition" ng-change="conditionChange(condition)">
      <option value="=">${ ::_.gettext('Is equal') }</option>
      <option value="!=">${ ::_.gettext('Is different') }</option>
    </select>
  </script>
</templates>

<templates>
  <script id="query.manager.jinja2" type="text/ng-template">
    <form class="col-12 margin-top-16">
      <div class="row">
        <div class="col-12">
          <h4>${(query && (query.category + ' / ' + query.name)) || "Selecione a consulta"}</h4>
        </div>
        <div class="col-md-6">
          <select class="form-control" ng-model="query" ng-options="q.name group by q.category for q in queries"
                  ng-change="queryChange(query)">
          </select>
          <div class="margin-top-8 toolbar" ng-show="query">
            <div class="btn-group">
              <button type="button" class="btn btn-primary" ng-click="action.saveSearch({ name: null })">
                {{ _.gettext('Save') }}
              </button>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div id="query-search-view" class="margin-bottom-8"></div>
          <div class="row" ng-if="query">
            <div class="col-sm-7">
              {% include "view.search.buttons.jinja2" %}
            </div>
            <div class="col-sm-5 toolbar">
              <div class="float-right">
                <div class="btn-group dropdown">
                  <button type="button" class="btn btn-outline-secondary dropdown-toggle" data-toggle="dropdown"
                          aria-haspopup="true">
                    <i class="fa fa-check-double"></i> Colunas
                  </button>
                  <ul class="dropdown-menu checkbox-menu">
                    <li class="dropdown-item" onclick="event.stopPropagation();$(this).find('input').click();"
                        ng-repeat="field in ::action.search.fields">
                      <label onclick="event.stopPropagation()">
                        <input type="checkbox" ng-model="field.visible"> ${ ::field.caption }
                      </label>
                    </li>
                  </ul>
                </div>

                <div class="btn-group" role="group">
                  <button class="btn btn-outline-secondary active" type="button" title="List view"
                          ng-click="action.switchView('list')"
                  >
                    <i class="fa fa-list"></i>
                  </button>
                  <button class="btn btn-outline-secondary" type="button" title="Cube view"
                          ng-click="action.switchView('cube')"
                  >
                    <i class="fa fa-dice-d6"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id="query-manager-result"></div>
    </form>
  </script>

  <script id="query.manager.table.jinja2" type="text/ng-template">
    <table class="table table-hover table-striped data-table margin-top-8">
      <thead>
      <tr>
        {% for f in fields %}
          <th class="sortable" ng-if="action.search.fields['{{ f.name }}'].visible"
              ng-click="action.orderBy('{{ f.name }}')"
          >{{ f.caption }}</th>
        {% endfor %}
      </tr>
      </thead>
      <tbody>
      <tr ng-repeat="record in records | orderBy : ordering : reverse">
        {% for f in query.fields %}
          <td ng-if="action.search.fields['{{ f.name }}'].visible">${ ::record['{{ f.name }}'] {{ f.filter }} }</td>
        {% endfor %}
      </tr>
      </tbody>
    </table>
  </script>

  <script id="query.manager.search.jinja2" type="text/ng-template">
    <search-view ng-show="query"/>
  </script>

	<script id="cube.jinja2" type="text/ng-template">
    <form class="col-12 margin-top-16">
      <div class="row">
        <div class="col-12">
          <h4>${(query && (query.category + ' / ' + query.name)) || "Selecione a consulta"}</h4>
        </div>
        <div class="col-md-6">
          <select class="form-control" ng-model="query" ng-options="q.name group by q.category for q in queries"
                  ng-change="queryChange(query)">
          </select>
        </div>
      </div>
      <div id="decision-cube"></div>
    </form>
  </script>
</templates>

<templates>
  <script id="view.report.jinja2" type="text/ng-template">
    <div ng-controller="ReportController">
      <form id="report-form" method="get" action="/web/reports/report/">
        <div class="data-heading panel panel-default">
          <div class="panel-body">
          <h2>{{ action.name }}</h2>
          <div class="toolbar">
            <button class="btn btn-primary" type="button" ng-click="report.preview()"><span class="fa fa-print fa-fw"></span> {{ _.gettext('Preview') }}</button>

            <div class="btn-group">
              <button class="btn btn-outline-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"
                      aria-expanded="false">{{ _.gettext('Export') }} <span class="caret"></span></button>
              <div class="dropdown-menu">
                <a class="dropdown-item" ng-click="Katrid.Reports.Reports.preview()">PDF</a>
                <a class="dropdown-item" ng-click="$event.preventDefault();report.telegram();">Telegram</a>
                <a class="dropdown-item" ng-click="Katrid.Reports.Reports.export('docx')">Word</a>
                <a class="dropdown-item" ng-click="Katrid.Reports.Reports.export('xlsx')">Excel</a>
                <a class="dropdown-item" ng-click="Katrid.Reports.Reports.export('pptx')">PowerPoint</a>
                <a class="dropdown-item" ng-click="Katrid.Reports.Reports.export('csv')">CSV</a>
                <a class="dropdown-item" ng-click="Katrid.Reports.Reports.export('txt')">{{ _.gettext('Text File') }}</a>
              </div>
            </div>

            <div class="btn-group">
              <button class="btn btn-outline-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"
                      aria-expanded="false">{{ _.gettext('My reports') }} <span class="caret"></span></button>
              <ul class="dropdown-menu">
              </ul>
            </div>

          <div class="pull-right btn-group">
            <button class="btn btn-outline-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"
                    aria-expanded="false"><i class="fa fa-sliders-h"></i></button>
            <div class="dropdown-menu">
              <a class="dropdown-item" href="javascript:void(0)" ng-click="report.saveDialog()">{{ _.gettext('Save') }}</a>
              <a class="dropdown-item" href="#">{{ _.gettext('Load') }}</a>
              <div class="dropdown-divider"></div>
              <h6 class="dropdown-header">Report Viewer</h6>
              <a class="dropdown-item" onclick="localStorage.setItem('katridReportViewer', 'pdf')">Visualizar em PDF</a>
              <a class="dropdown-item" onclick="localStorage.setItem('katridReportViewer', 'native')">Visualizador Nativo</a>
            </div>
          </div>

          </div>
        </div>
        </div>
        <div class="col-sm-12">
          <table class="col-sm-12" style="margin-top: 20px; display:none;">
            <tr>
              <td colspan="2" style="padding-top: 8px;">
                <label>{{ _.gettext('My reports') }}</label>

                <select class="form-control" ng-change="action.userReportChanged(action.userReport.id)" ng-model="action.userReport.id">
                    <option value=""></option>
                    <option ng-repeat="rep in userReports" value="${ rep.id }">${ rep.name }</option>
                </select>
              </td>
            </tr>
          </table>
        </div>
      <div id="report-params">
      <div id="params-fields" class="col-sm-12 form-group" ng-if="::customizableReport">
        <div class="checkbox"><label><input type="checkbox" ng-model="paramsAdvancedOptions"> {{ _.gettext('Advanced options') }}</label></div>
        <div ng-show="paramsAdvancedOptions">
          <div class="form-group">
            <label>{{ _.gettext('Printable Fields') }}</label>
            <input type="hidden" id="report-id-fields"/>
          </div>
          <div class="form-group">
            <label>{{ _.gettext('Totalizing Fields') }}</label>
            <input type="hidden" id="report-id-totals"/>
          </div>
        </div>
      </div>

      <div class="clearfix"></div>

      </div>
        <div ng-if="::advancedOptions">
        <div id="params-sorting" class="col-sm-12 form-group">
          <label class="control-label">{{ _.gettext('Sorting') }}</label>
          <select multiple id="report-id-sorting"></select>
        </div>

        <div id="params-grouping" class="col-sm-12 form-group">
          <label class="control-label">{{ _.gettext('Grouping') }}</label>
          <select multiple id="report-id-grouping"></select>
        </div>
        <hr>
        <table class="col-sm-12">
          <tr>
            <td class="col-sm-4">
              ${ 'teste' }
              <select class="form-control" ng-model="newParam">
                <option value="">--- {{ _.gettext('FILTERS') }} ---</option>
                <option ng-repeat="field in report.fields" value="${ field.name }">${ field.label }</option>
              </select>
            </td>
            <td class="col-sm-8">
              <button
                  class="btn btn-outline-secondary" type="button"
                  ng-click="report.addParam(newParam)">
                <i class="fa fa-plus fa-fw"></i> {{ _.gettext('Add Parameter') }}
              </button>
            </td>
          </tr>
        </table>
        <div class="clearfix"></div>
        <hr>
      </div>
      <div id="params-params" class="params-params margin-top-8 row">
        <div ng-repeat="param in report.params" ng-controller="ReportParamController" class="col-lg-6 form-group">
          <div class="col-12">
            <label class="control-label">${ param.label }</label>
          </div>
          <div class="col-4" ng-if="param.operationsVisible">
            <select ng-model="param.operation" class="form-control" ng-change="param.setOperation(param.operation)">
              <option ng-repeat="op in param.operations" value="${op.id}">${op.text}</option>
            </select>
          </div>
          <div class="col param-widget"></div>
        </div>
      </div>
      </form>
    </div>
  </script>
</templates>

<templates>
  <script id="view.search.jinja2" type="text/ng-template">
    <div search-view-area class="search-area">
      <div class="search-view">
        <div class="search-view-facets">
          <div class="facet-view" ng-repeat="facet in action.searchView.facets">
            <span class="facet-label" ng-bind-html="facet.caption"></span>
            <span class="facet-value" ng-bind-html="facet.templateValue"></span>
            <span class="fas fa-times facet-remove" ng-click="action.searchView.remove($index)"></span>
          </div>
        </div>
        <input class="search-view-input" role="search" placeholder="{{ _.gettext('Search...') }}"
               ng-model="action.searchView.text">
        <span
            ng-class="{'fa-search-plus': !action.searchView.viewMoreButtons, 'fa-search-minus': action.searchView.viewMoreButtons}"
            class="search-view-more fa" ng-click="action.searchView.viewMoreButtons=!action.searchView.viewMoreButtons">
        </span>
      </div>
      <div class="col-sm-12">
        <ul class="search-dropdown-menu search-view-menu" role="menu">
          <li ng-repeat="item in action.searchView.$items">
            <a ng-if="item.expandable" class="expandable" href="#" onclick="event.preventDefault();"
               ng-mousedown="item.expanded=!item.expanded;$event.preventDefault();$event.stopPropagation();">
              <i class="fa" ng-class="{'fa-angle-down': item.expanded, 'fa-angle-right': !item.expanded}"></i>
            </a>
            <a href="#" class="search-menu-item" ng-mousedown="$event.preventDefault();$event.stopPropagation();"
               ng-click="item.select();$event.preventDefault();" ng-class="::{'indent': item.indent}">
              <span ng-if="::!item.indent" ng-bind-html="item.template"></span>
              <span ng-if="::item.indent">${ ::item.text }</span>
            </a>
            <a ng-if="item.loading" class="search-menu-item"><i>{{ _.gettext('Loading...') }}</i></a>
          </li>
        </ul>
      </div>
    </div>
  </script>

  <script id="view.search.buttons.jinja2" type="text/ng-template">
    <div class="btn-group search-view-more-area" ng-show="(action.viewType !== 'form') && action.searchView.viewMoreButtons">
      <div custom-filter class="btn-group">
        <button class="btn btn-outline-secondary dropdown-toggle" data-toggle="dropdown" type="button"
                aria-expanded="false">
          <span class="fa fa-filter fa-fw"></span> {{ _.gettext('Filters') }} <span class="caret"></span>
        </button>
        {% include "view.search.menu.jinja2" %}
      </div>
      <div class="btn-group">
        <button class="btn btn-outline-secondary dropdown-toggle" data-toggle="dropdown" type="button">
          <span class="fa fa-bars fa-fw"></span> {{ _.gettext('Group By') }} <span class="caret"></span>
        </button>
        <div class="dropdown-menu search-view-groups-menu">

          <div>
            <div ng-repeat="group in action.searchView.groups">
              <a class="dropdown-item" ng-class="{'selected': filter.selected}" ng-repeat="filter in group"
                 ng-click="filter.toggle();$event.stopPropagation();">
                ${ filter.toString() }
              </a>
              <div class="dropdown-divider"></div>
            </div>
          </div>

          <a class="dropdown-item dropdown-search-item" onclick="event.stopPropagation();event.preventDefault();"
             ng-click="groupByExpanded=!groupByExpanded">
            <i ng-class="{ 'fa-caret-right': !groupByExpanded, 'fa-caret-down': groupByExpanded }"
               class="fa expandable"></i>
            {{ _.gettext('Add Custom Group') }}
          </a>

          <div ng-if="groupByExpanded" onclick="event.stopPropagation();event.preventDefault();">
            <div class="col-12">
              <div class="form-group">
                <select class="form-control" ng-model="fieldName" ng-change="fieldChange(action.fields[fieldName])">
                  <option value=""></option>
                  <option ng-repeat="field in action.fieldList|orderBy:'caption'" value="${ field.name }">${ field.caption
                    }
                  </option>
                </select>
              </div>
              <div class="form-group">
                <button class="btn btn-primary" type="button" ng-click="action.searchView.addCustomGroup(action.fields[fieldName]);fieldName='';">
                  {{ _.gettext('Apply') }}
                </button>
              </div>
            </div>
          </div>

        </div>
      </div>
      <div class="btn-group">
        <button class="btn btn-outline-secondary dropdown-toggle" data-toggle="dropdown" type="button"
                aria-expanded="false">
          <span class="fa fa-star fa-fw"></span> {{ _.gettext('Favorites') }} <span class="caret"></span>
        </button>
        <div class="dropdown-menu search-favorite-menu" style="min-width: 300px">
          <a class="dropdown-item dropdown-search-item" onclick="event.stopPropagation();event.preventDefault();"
             ng-click="saveSearchExpanded=!saveSearchExpanded">
            <i ng-class="{ 'fa-caret-right': !saveSearchExpanded, 'fa-caret-down': saveSearchExpanded }"
               class="fa expandable"></i>
            {{ _.gettext('Save current search') }}
          </a>
          <div ng-if="saveSearchExpanded" onclick="event.stopPropagation();">
            <div class="col-12">
              <div class="form-group">
                <input type="text" class="form-control" ng-model="saveSearch.name" placeholder="{{ _.gettext('Search name') }}">
              </div>
              <div class="form-group" ng-init="saveSearch.is_default=false;saveSearch.is_shared=true;">
                <label>
                  <input type="checkbox" ng-model="saveSearch.is_default" onclick="event.stopPropagation();">
                  {{ _.gettext("Use by default") }}
                </label>
                <label>
                  <input type="checkbox" ng-model="saveSearch.is_shared">
                  {{ _.gettext("Share with all users") }}
                </label>
              </div>
              <div class="form-group">
                <button class="btn btn-primary" type="button" ng-click="action.saveSearch(saveSearch)">
                  {{ _.gettext('Save') }}
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </script>

  <script id="view.search.menu.jinja2" type="text/ng-template">
    <div class="dropdown-menu search-view-filter-menu">
      <div>
        <div ng-repeat="group in action.searchView.filterGroups">
          <a class="dropdown-item" ng-class="{'selected': filter.selected}" ng-repeat="filter in group"
             ng-click="filter.toggle();$event.stopPropagation();">
            ${ filter.toString() }
          </a>
          <div class="dropdown-divider"></div>
        </div>
      </div>
      <div ng-controller="CustomFilterController">
        <div ng-repeat="filter in customFilter">
          <a class="dropdown-item" ng-class="{'selected': filterItem.selected}"
             ng-click="filterItem.toggle();$event.stopPropagation();$event.preventDefault();"
             ng-repeat="filterItem in filter" ng-bind-html="filterItem.toString()"></a>
          <div class="dropdown-divider"></div>
        </div>
        <a class="dropdown-item dropdown-search-item" onclick="event.stopPropagation();event.preventDefault();"
           ng-click="customSearchExpanded=!customSearchExpanded">
          <i ng-class="{ 'fa-caret-right': !customSearchExpanded, 'fa-caret-down': customSearchExpanded }"
             class="fa expandable"></i>
          {{ _.gettext('Add Custom Filter') }}
        </a>

        <div ng-if="customSearchExpanded" onclick="event.stopPropagation();event.preventDefault();">
          <div ng-show="tempFilter.length" class="margin-bottom-8">
            <a href="#" onclick="$event.preventDefault()" class="dropdown-item"
               ng-repeat="filter in tempFilter" ng-bind-html="filter.toString()"
               title="{{ _.gettext('Remove item') }}"></a>
          </div>
          <div class="col-12">
            <div class="form-group">
              <select class="form-control" ng-model="fieldName" ng-change="fieldChange(action.fields[fieldName])">
                <option value=""></option>
                <option ng-repeat="field in action.fieldList|orderBy:'caption'" value="${ field.name }">${ field.caption
                  }
                </option>
              </select>
            </div>
            <div class="form-group">
              <ng-include src="field.getParamTemplate() + '.conditions'"/>
            </div>
            <div class="form-group">
              <ng-include src="field.getParamTemplate()" ng-show="controlVisible"/>
            </div>
            <div class="form-group">
              <button class="btn btn-primary" type="button" ng-click="applyFilter(field, condition, searchValue)" ng-show="searchValue!==undefined">
                {{ _.gettext('Apply') }}
              </button>
              <button class="btn btn-outline-secondary" type="button"
                      ng-click="addCondition(field, condition, searchValue);fieldName='';" ng-show="searchValue">
                {{ _.gettext('Add a condition') }}
              </button>
            </div>
          </div>
        </div>

      </div>
    </div>
  </script>
</templates>

<templates>

  <script id="view.card.jinja2" type="text/ng-template">
    <div class="content no-padding">
      <div class="data-panel col-12">
        <div class="card-view kanban" ng-if="groups.length">

          <div ng-repeat="group in groups" class="card-group sortable-item" data-id="{{ group._paramValue }}"
               data-group-name="{{ group._paramName }}"
               ng-init="action.loadGroupRecords(group)"
          >
            <div class="card-header margin-bottom-8">
              <div class="pull-right" ng-if="false">
                <button class="btn" ng-click="cardShowAddGroupItemDlg = true"><i class="fa fa-plus"></i></button>
              </div>
              <h4 ng-bind="group.__str__" title="${group.count} Registros"></h4>
              <div class="clearfix"></div>

              <form id="card-add-group-item-dlg" ng-submit="cardAddItem($event, cardNewName)"
                    ng-if="cardShowAddGroupItemDlg && false">
                <div class="form-group">
                  <input ng-model="cardNewName" ng-init="cardNewName = ''" class="form-control"
                         ng-esc="cardHideAddGroupItemDlg($event)" placeholder="{{ _.gettext('Add') }}"
                         ng-blur="cardHideAddGroupItemDlg($event)">
                </div>
                <button type="submit" class="btn btn-primary"
                        onmousedown="event.preventDefault();event.stopPropagation();">${Katrid.i18n.gettext('Add')}
                </button>
                <button class="btn btn-default">{{ _.gettext('Cancel') }}</button>
              </form>

            </div>
            <div class="card-items" card-draggable=".card-items" card-item>
              <div ng-repeat="record in group.records" class="card panel-default card-item card-link sortable-item"
                   ng-click="action.listRowClick($index, record, $event)"
              >
                {{ content }}
              </div>
            </div>
          </div>
          <div class="card-add-group" title="{{ _.gettext('Click here to add new column') }}"
               ng-if="false"
               ng-click="cardNewName='';cardShowAddGroupDlg($event);" data-group-name="{{ groupings[0]._paramName }}">
            <div ng-hide="cardAddGroupDlg">
              <i class="fa fa-fw fa-chevron-right fa-2x"></i>
              <div class="clearfix"></div>
              <span class="title">{{ _.gettext('Add New Column') }}</span>
            </div>
            <form ng-show="cardAddGroupDlg" ng-submit="cardAddGroup($event, cardNewName)">
              <div class="form-group">
                <input class="form-control" ng-blur="cardAddGroupDlg=false" ng-esc="cardAddGroupDlg=false"
                       placeholder="{{ _.gettext('Add') }}" ng-model="cardNewName">
              </div>
              <button type="submit" class="btn btn-primary">{{ _.gettext('Add') }}</button>
              <button type="button" class="btn btn-default">{{ _.gettext('Cancel') }}</button>
            </form>
          </div>
        </div>
        <div class="card-view card-deck" ng-if="!groups.length">
          <div ng-repeat="record in records" class="card panel-default card-item card-link"
               ng-click="action.listRowClick($index, record, $event)">
            {{ content }}
          </div>
          <div class="card-item card-ghost"></div>
          <div class="card-item card-ghost"></div>
          <div class="card-item card-ghost"></div>
          <div class="card-item card-ghost"></div>
          <div class="card-item card-ghost"></div>
          <div class="card-item card-ghost"></div>
          <div class="card-item card-ghost"></div>
          <div class="card-item card-ghost"></div>
          <div class="card-item card-ghost"></div>
          <div class="card-item card-ghost"></div>
          <div class="card-item card-ghost"></div>
        </div>

      </div>
    </div>

  </script>
</templates>

<templates>
  <script id="view.form.field.utils.jinja2" type="text/ng-template">
    {% macro field_attrs(field) %}
      name="{{ field.name }}"
      ng-model="record.{{ field.name }}"
      {% if field.attrs.ngFieldChange %}
        ng-change="{{ field.attrs.ngFieldChange }}"
      {% endif %}
    {% endmacro %}
  </script>

  <script id="view.form.field.jinja2" type="text/ng-template">
    {% import "view.form.field.utils.jinja2" as utils %}
    <section class="form-group
		    {% block css_class %}{{ field.cssClass }}{% endblock %}
		    {% block cols %} {% if window.isNaN(field.cols) %}{{ field.cols }}{% else %}col-md-{{ field.cols }}{% endif %} {% endblock %}"
        {% if field.ngShow %}
             ng-show="{{ field.ngShow }}"
        {% endif %}
        {% if field.ngIf %}
             ng-if="{{ field.ngIf }}"
        {% endif %}
        {% if field.ngClass %}
             ng-class="{{ field.ngClass }}"
        {% endif %}
        {% if field.ngReadonly %}
             ng-readonly="{{ field.ngReadonly }}"
        {% elif field.readonly %}
             readonly="true"
        {% endif %}
    >
      {% block label %}
        {% if not field.attrs.nolabel %}
          <label class="form-label">
            {{ field.caption }}
          </label>
        {% endif %}
      {% endblock %}
      {% block span %}
        <span class="form-field-readonly">
        {% block readonly %}
          ${ record.{{ field.name }} || '{{ field.emptyText }}'}
        {% endblock %}
        </span>
      {% endblock %}
      {% block field %}
        <input {% block fields_css %}class="form-field form-control"{% endblock %} {% block input_type %}type="text"{% endblock %} {{ utils.field_attrs(field) }}
          {% if field.attrs.nolabel === 'placeholder' %}
          placeholder="{{ field.caption }}"
          {% endif %}
		      {% block field_attrs %}input-field{% endblock %}
        >
      {% endblock %}
    </section>
  </script>

  <script id="view.form.selection-field.jinja2" type="text/ng-template">
    {% extends "view.form.field.jinja2" %}
    {% block readonly %}
      ${ view.fields.{{ field.name }}.displayChoices[record.{{ field.name }}] || '{{ field.emptyText }}' }
    {% endblock %}
    {% block field %}
      <select class="form-field form-control" name="{{ field.name }}" ng-model="record.{{ field.name }}">
        <option ng-repeat="choice in view.fields.{{ field.name }}.choices" value="${ choice[0] }">
          ${ choice[1] }
        </option>
      </select>
    {% endblock %}
  </script>

  <script id="view.form.foreignkey.jinja2" type="text/ng-template">
    {% extends "view.form.field.jinja2" %}
    {% block css_class %}ForeignKey{% endblock %}
    {% block readonly %}
      <a href="#/app/?menu_id=${ ::action.params.menu_id }&model={{ field.model }}&view_type=form&id=${ record.{{ field.name }}[0] }">
        ${ record.{{ field.name }}[1]||'{{ field.emptyText }}' }
      </a>
    {% endblock %}
    {% block fields_css %}{% endblock %}
    {% block field_attrs %}
      foreignkey
    {% endblock %}
  </script>

  <script id="view.form.autocomplete.jinja2" type="text/ng-template">
    {% extends "view.form.field.jinja2" %}
    {% block readonly %}
      <a href="#/app/?menu_id=${ ::action.params.menu_id }&model={{ field.model }}&view_type=form&id=${ record.{{ field.name }}[0] }">
        ${ record.{{ field.name }}[1]||'{{ field.emptyText }}' }
      </a>
    {% endblock %}
    {% block field_attrs %}input-field fk-autocomplete ng-model-options="{updateOn: 'change'}"{% endblock %}
  </script>

  <script id="view.form.manytomany.jinja2" type="text/ng-template">
    {% extends "view.form.foreignkey.jinja2" %}
    {% block readonly %}
      <a href="#/app/?menu_id=${ ::action.params.menu_id }&model={{ field.model }}&view_type=form&id=${ record.{{ field.name }}[0] }">
        <span ng-repeat="val in record.{{ field.name }}">
        ${ val[1] }
        </span>
      </a>
    {% endblock %}
    {% block field_attrs %}
      foreignkey multiple
    {% endblock %}
  </script>

  <script id="view.form.image-field.jinja2" type="text/ng-template">
    {% extends "view.form.field.jinja2" %}
    {% block span %}
    {% endblock %}
    {% block field %}
      <div class="image-box image-field">
        <img ng-src="{{ field.ngSrc }}">
        <div class="text-right image-box-buttons">
          <button class="btn btn-default" type="button" title="{{ _.gettext('Change') }}"
                  onclick="$(this).closest('.image-box').find('input').trigger('click')">
            <i class="fa fa-pen"></i>
          </button>
          <button class="btn btn-default" type="button" title="{{ _.gettext('Clear') }}"
                  ng-click="record.{{ attrs.name }} = null">
            <i class="fa fa-trash"></i>
          </button>
        </div>
        <input type="file" name="{{ field.name }}" file-reader accept="image/*" ng-model="record.{{ field.name }}">
      </div>
    {% endblock %}
  </script>

  <script id="view.form.boolean-field.jinja2" type="text/ng-template">
    {% extends "view.form.field.jinja2" %}
    {% block label %}
      <label class="form-label form-label-checkbox">
        <span class="checkbox-span">
        {{ field.caption }}
        </span>
        <span>
        &nbsp;
        </span>
      </label>
    {% endblock %}
    {% block readonly %}
      ${ record.{{ field.name }} ? '{{ _.gettext('yes') }}' : '{{ _.gettext('no') }}' }
    {% endblock %}
    {% block field %}
      <label class="checkbox" ng-show="action.dataSource.changing">
        <input class="form-field form-control" name="{{ field.name }}" ng-model="record.{{ field.name }}"
               type="checkbox">
        {% if field.helpText %}
          {{ field.helpText }}
        {% else %}
          {{ field.caption }}
        {% endif %}
        <i class="fas"></i>
      </label>
    {% endblock %}
  </script>

  <script id="view.form.text-field.jinja2" type="text/ng-template">
    {% extends "view.form.field.jinja2" %}
    {% block css_class %}TextField{% endblock %}
    {% block field %}
      <textarea class="form-field form-control" name="{{ field.name }}" ng-model="record.{{ field.name }}"></textarea>
    {% endblock %}
  </script>

  <script id="view.form.password.jinja2" type="text/ng-template">
    {% extends "view.form.field.jinja2" %}
    {% block readonly %}**********************{% endblock %}
    {% block input_type %}type="password"{% endblock %}
  </script>

  <script id="view.form.code-editor.jinja2" type="text/ng-template">
    {% extends "view.form.field.jinja2" %}
    {% block span %}{% endblock %}
    {% block css_class %}CodeEditor{% endblock %}
    {% block field %}
      <div code-editor class="code-editor" name="{{ field.name }}" language="{% block language %}html{% endblock %}"
           ng-model="record.{{ field.name }}"></div>
    {% endblock %}
  </script>

  <script id="view.form.json-field.jinja2" type="text/ng-template">
    {% extends "view.form.code-editor.jinja2" %}
    {% block language %}json{% endblock %}
  </script>

  <script id="view.form.python-code.jinja2" type="text/ng-template">
    {% extends "view.form.code-editor.jinja2" %}
    {% block language %}python{% endblock %}
  </script>

  <script id="view.form.sql-editor.jinja2" type="text/ng-template">
    {% extends "view.form.code-editor.jinja2" %}
    {% block language %}sql{% endblock %}
  </script>

  <script id="view.form.grid.jinja2" type="text/ng-template">
    {% extends "view.form.field.jinja2" %}
    {% block span %}
    {% endblock %}
    {% block field %}
      <onetomany-field name="{{ field.name }}"
          {% if attrs.inlineEditor %}
            inline-editor
          {% endif %}
      >
        {{ content }}
      </onetomany-field>
    {% endblock %}
  </script>

  <script id="view.form.numeric-field.jinja2" type="text/ng-template">
    {% extends "view.form.field.jinja2" %}

    {% block readonly %}
      ${ (record.{{ field.name }}|number:0) || '{{ field.emptyText }}' }
    {% endblock %}
    {% block field_attrs %}
      input-field
      input-decimal="0"
      inputmode="numeric"
    {% endblock %}
  </script>

  <script id="view.form.decimal-field.jinja2" type="text/ng-template">
    {% extends "view.form.field.jinja2" %}

    {% block readonly %}
      ${ (record.{{ field.name }}|number:{{ field.decimalPlaces or 0 }}) || '{{ field.emptyText }}' }
    {% endblock %}
    {% block field_attrs %}
      input-field
      input-decimal="{{ field.decimalPlaces }}"
      inputmode="decimal"
    {% endblock %}
  </script>

  <script id="view.form.date-field.jinja2" type="text/ng-template">
    {% extends "view.form.field.jinja2" %}
    {% block readonly %}
      ${ (record.{{ field.name }}|date:'{% block format %}shortDate{% endblock %}') || '{{ field.emptyText }}' }
    {% endblock %}
    {% block field %}
      <div class="input-group date">
        <input input-field date-picker="{% block date_picker %}L{% endblock %}" type="text" name="{{ field.name }}" class="form-field form-control"
               ng-model="record.{{ field.name }}" inputmode="numeric">
        <div class="input-group-append input-group-addon">
          <div class="input-group-text">
            <i class="fa fa-calendar fa-sm"></i>
          </div>
        </div>
      </div>
    {% endblock %}
  </script>

  <script id="view.form.datetime-field.jinja2" type="text/ng-template">
    {% extends "view.form.date-field.jinja2" %}
    {% block format %}short{% endblock %}
    {% block date_picker %}L LT{% endblock %}
  </script>

  <script id="view.form.time-field.jinja2" type="text/ng-template">
    {% extends "view.form.field.jinja2" %}
    {% block readonly %}
      ${ (record.{{ field.name }}|date:'shortTime') || '{{ field.emptyText }}' }
    {% endblock %}
    {% block field_attrs %}type="text" time-picker{% endblock %}
  </script>

  <script id="view.field.OneToManyField.Dialog.jinja2" type="text/ng-template">
    <div class="modal fade" tabindex="-1" role="dialog">
      <div class="modal-dialog modal-lg form-view" role="document"
           ng-class="{'form-data-changing': dataSource.changing, 'form-data-readonly': !dataSource.changing}">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">{{ field.caption }}</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                aria-hidden="true">&times;</span></button>
          </div>
          <div class="modal-body">
            {{ content }}
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" type="button" ng-click="save()" ng-show="dataSource.changing">
              {{ _.gettext('Save') }}
            </button>
            <button type="button" class="btn btn-outline-secondary" type="button" data-dismiss="modal"
                    ng-show="dataSource.changing">
              {{ _.gettext('Cancel') }}
            </button>
            <button type="button" class="btn btn-outline-secondary" type="button" data-dismiss="modal"
                    ng-show="!dataSource.changing">
              {{ _.gettext('Close') }}
            </button>
          </div>
        </div>
      </div>
    </div>
  </script>
</templates>

<templates>

  <script id="ui.action.window.jinja2" type="text/ng-template">
    <action-view>
      {% include "view.toolbar.jinja2" %}
      <div class="action-view-content content-scroll"></div>
    </action-view>
  </script>

  <script id="view.header.jinja2" type="text/ng-template">
  </script>

  <script id="view.breadcrumb.jinja2" type="text/ng-template">
    <ol class="breadcrumb">
      {% for b in breadcrumb %}
      <li class="breadcrumb-item">
        {% if not b.isLeaf %}<a href="#" ng-click="$event.preventDefault();action.backTo({{ loop.index - 1 }})">{% endif %}
        {{ b.text }}
        {% if not b.isLeaf %}</a>{% endif %}
      </li>
      {% endfor %}
    </ol>
  </script>

  <script id="view.toolbar.jinja2" type="text/ng-template">
    <div class="data-heading panel panel-default">
      <div class="panel-body">
        <div class="row">
          <div class="col-sm-6 breadcrumb-nav">
          </div>
          <search-view ng-show="action.viewType !== 'form'" class="col-md-6"/>
          <!--<p class="help-block">${ action.info.usage }&nbsp;</p>-->
        </div>
        <div class="toolbar row">
          <div class="col-sm-6 toolbar-action-buttons">

            {% include "view.buttons.jinja2" %}

            <!--button class="btn btn-default" ng-click="dataSource.refresh()"><i class="fa fa-refresh"></i> ${ Katrid.i18n.gettext('Refresh') }</button-->

          </div>
          <div class="col-sm-6">

            {% include "view.search.buttons.jinja2" %}

            <div class="float-right" ng-if="action.viewType !== 'form'">
              <div class="btn-group pagination-area">
                <span ng-show="action.dataSource.pendingRequest"><span class="fas fa-spinner fa-spin"/>  {{ _.gettext('Loading...') }}</span>
                <div ng-show="!action.dataSource.pendingRequest">
                <span
                    class="paginator">${action.dataSource.offset|number} - ${action.dataSource.offsetLimit|number}</span>
                  /
                  <span class="total-pages">${action.dataSource.recordCount|number}</span>
                </div>
              </div>
              <div class="btn-group">
                <button class="btn btn-outline-secondary" type="button" ng-click="action.dataSource.prevPage()">
                  <i class="fa fa-chevron-left"></i>
                </button>
                <button class="btn btn-outline-secondary" type="button" ng-click="action.dataSource.nextPage()">
                  <i class="fa fa-chevron-right"></i>
                </button>
              </div>

              <div class="btn-group" role="group">
                {% if action.viewModes.includes('card') %}
                  <button class="btn btn-outline-secondary" type="button" ng-click="action.switchView('card')">
                    <i class="fa fa-th-large"></i>
                  </button>
                {% endif %}
                {% if action.viewModes.includes('list') %}
                  <button class="btn btn-outline-secondary" type="button" ng-click="action.switchView('list')">
                    <i class="fa fa-list"></i>
                  </button>
                {% endif %}
                {% if action.viewModes.includes('calendar') %}
                  <button class="btn btn-outline-secondary" type="button" ng-click="action.viewType = 'calendar'">
                    <i class="fa fa-calendar"></i>
                  </button>
                {% endif %}
                {% if action.viewModes.includes('chart') %}
                  <button class="btn btn-outline-secondary" type="button" ng-click="action.viewType = 'chart'">
                    <i class="fa fa-bar-chart-o"></i>
                  </button>
                {% endif %}
              </div>

            </div>
            <div class="float-right" ng-if="action.viewType === 'form'">
              <div class="btn-group pagination-area">
              <span ng-if="action.dataSource.records.length">
                ${ action.dataSource.recordIndex + 1 } / ${ records.length }
              </span>
              </div>
              <div class="btn-group" role="group">
                <button class="btn btn-outline-secondary" type="button" ng-click="action.dataSource.prior('form')">
                  <i class="fa fa-chevron-left"></i>
                </button>
                <button class="btn btn-outline-secondary" type="button" ng-click="action.dataSource.next('form')">
                  <i class="fa fa-chevron-right"></i>
                </button>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </script>

  <script id="view.buttons.jinja2" type="text/ng-template">
    <div ng-show="action.viewType !== 'form'" class="btn-toolbar">
      <button class="btn btn-primary toolbutton-action-create" type="button" ng-click="action.createNew()">
        {{ _.gettext('Create') }}
      </button>
    </div>

    <div ng-if="action.viewType === 'form'" class="btn-toolbar">
      <button class="btn btn-primary toolbutton-action-save" ng-if="action.viewType" type="button" ng-disabled="action.dataSource.uploading"
              ng-click="action.dataSource.save()" ng-show="action.dataSource.changing">
        {{ _.gettext('Save') }}
      </button>
      <button class="btn btn-primary toolbutton-action-edit" type="button" ng-disabled="action.dataSource.uploading"
              ng-click="action.dataSource.edit()" ng-show="!action.dataSource.changing">
        {{ _.gettext('Edit') }}
      </button>
      <button class="btn btn-outline-secondary toolbutton-action-create" type="button" ng-disabled="action.dataSource.uploading"
              ng-click="action.dataSource.insert()" ng-show="!action.dataSource.changing">
        {{ _.gettext('Create') }}
      </button>
      <button class="btn btn-outline-secondary toolbutton-action-cancel" type="button" ng-click="action.dataSource.cancel()"
              ng-show="action.dataSource.changing">
        {{ _.gettext('Cancel') }}
      </button>
    </div>

    {% include "view.buttons.reports.jinja2" %}
    {% include "view.buttons.attachments.jinja2" %}
    {% include "view.buttons.actions.jinja2" %}
  </script>

  <script id="view.buttons.reports.jinja2" type="text/ng-template">
    <div class="btn-group" ng-show="action.selectionLength">
      <button type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true">
        {{ _.gettext('Print') }} <span class="caret"></span>
      </button>
      <div class="dropdown-menu">
        <a class="dropdown-item" ng-click="action.autoReport()">
          {{ _.gettext('Auto Report') }}
        </a>

        <a ng-repeat="bindingAction in view.toolbar.print" class="dropdown-item" data-id="${ bindingAction.id }"
           ng-click="$parent.action.doBindingAction($event)">
          ${ bindingAction.name }
        </a>

      </div>
    </div>
  </script>

  <script id="view.buttons.attachments.jinja2" type="text/ng-template">

    <attachments-button class="btn-group" ng-if="action.viewType === 'form'">
      <div class="dropdown">
        <button id="attachments-button" attachments-button="" ng-show="!action.dataSource.inserting"
                type="button" class="btn btn-outline-secondary dropdown-toggle"
                data-toggle="dropdown" aria-haspopup="true">
          <span ng-if="!attachments.length">{{ _.gettext('Attachments') }} </span>
          <span
              ng-if="attachments.length">${ _.sprintf(_.gettext('%d Attachment(s)'), attachments.length) }</span>
          <span class="caret"></span>
        </button>
        <div class="dropdown-menu attachments-menu">
          <a class="dropdown-item position-relative" ng-repeat="attachment in attachments"
             href="${ ::attachment.download_url }">
            ${ attachment.name } <span
              class="fa fa-times remove-attachment-button" title="{{ _.gettext('Delete attachment') }}"
              ng-click="$event.preventDefault();action.deleteAttachment(attachments, $index);$event.stopPropagation();"></span>
          </a>
          <div role="separator" class="dropdown-divider" ng-show="attachments.length"></div>
          <a class="dropdown-item" onclick="$(this).next().click();">
            {{ _.gettext('Add...') }}
          </a>
          <input type="file" class="input-file-hidden" multiple="multiple"
                 onchange="Katrid.Services.Attachments.upload(this)"/>
        </div>
      </div>
    </attachments-button>

  </script>

  <script id="view.buttons.actions.jinja2" type="text/ng-template">

    <div class="btn-group">
      <div class="dropdown">
        <button type="button" class="btn btn-outline-secondary dropdown-toggle" data-toggle="dropdown" ng-show="action.selectionLength"
                aria-haspopup="true">
          {{ _.gettext('Action') }} <span class="caret"></span>
        </button>
        <button type="button" class="btn toolbtn" ng-if="!action.dataSource.editing" ng-click="action.refresh()" title="Atualizar">
          <i class="fa fa-fw fa-redo-alt"></i>
        </button>
        <div class="dropdown-menu dropdown-menu-actions">
          <a class="dropdown-item" ng-click="action.deleteSelection()">
            <i class="fa fa-fw fa-trash-o"></i> {{ _.gettext('Delete') }}
          </a>
          <a class="dropdown-item" ng-click="action.copy()" ng-if="action.viewType === 'form'">
            <i class="fa fa-fw fa-files-o"></i>
            {{ _.gettext('Duplicate') }}
          </a>
          <a class="dropdown-item" ng-if="(action.viewType === 'form') && $parent.record.id" ng-repeat="opt in ::copyToOpts"
             ng-click="action.copyTo(opt.id)">
            <i class="fa fa-fw fa-files-o"></i>
            {{ _.sprintf(_.gettext('Copy To %s'), opt.name) }}
          </a>
          <!-- replace-actions -->
        </div>
      </div>
    </div>

  </script>

</templates>

<templates>
  <script id="view.list.field.jinja2" type="text/ng-template">
    <th class="{% block th_css_class %}{{ field.cssClass }}{% endblock %}">
    <span>
      {{ field.caption }}
    </span>
    </th>
    <td class="{% block td_css_class %}{{ field.cssClass }}{% endblock %}">
      {% if html %}
        {{ html }}
      {% else %}
          {% if inplaceEditor %}
          {% else %}
            {% block span %}
              <span>
              {% block span_content %}
                ${ record.{{ field.name }} }
              {% endblock %}
              </span>
            {% endblock %}
          {% endif %}
      {% endif %}
    </td>
  </script>
  <script id="view.list.selection-field.jinja2" type="text/ng-template">
    {% extends "view.list.field.jinja2" %}
    {% block span_content %}
      ${ view.fields['{{ field.name }}'].displayChoices[record.{{ field.name }}] || '{{ field.emptyText }}' }
    {% endblock %}
  </script>

  <script id="view.list.foreignkey.jinja2" type="text/ng-template">
    {% extends "view.list.field.jinja2" %}
    {% block span_content %}
      ${record.{{ field.name }}[1] }
    {% endblock %}
  </script>

  <script id="view.list.date-field.jinja2" type="text/ng-template">
    {% extends "view.list.field.jinja2" %}
    {% block span_content %}
      ${ (record.{{ field.name }}|date:'shortDate') || '{{ field.emptyText }}' }
    {% endblock %}
  </script>

  <script id="view.list.datetime-field.jinja2" type="text/ng-template">
    {% extends "view.list.field.jinja2" %}
    {% block span_content %}
      ${ (record.{{ field.name }}|date:'short') || '{{ field.emptyText }}' }
    {% endblock %}
  </script>

  <script id="view.list.time-field.jinja2" type="text/ng-template">
    {% extends "view.list.field.jinja2" %}
    {% block span_content %}
      ${ (record.{{ field.name }}|date:'shortTime') || '{{ field.emptyText }}' }
    {% endblock %}
  </script>

  <script id="view.list.numeric-field.jinja2" type="text/ng-template">
    {% extends "view.list.field.jinja2" %}
    {% block span_content %}
      ${ (record.{{ field.name }}|number:0) || '{{ field.emptyText }}' }
    {% endblock %}
  </script>

  <script id="view.list.decimal-field.jinja2" type="text/ng-template">
    {% extends "view.list.field.jinja2" %}
    {% block span_content %}
      ${ (record.{{ field.name }}|number:2) || '{{ field.emptyText }}' }
    {% endblock %}
  </script>

  <script id="view.list.boolean-field.jinja2" type="text/ng-template">
    {% extends "view.list.field.jinja2" %}
    {% block span_content %}
    ${ record.{{ field.name }} ? '{{ _.gettext('yes') }}' : '{{ _.gettext('no') }}' }
    {% endblock %}
  </script>

</templates>

<templates>
  <script id="view.list.html" type="text/ng-template">
    <div class="content no-padding">
      <div class="clearfix"></div>
      <header class="content-container-heading"></header>
      <div class="panel-default data-panel">
        <div class="panel-body no-padding">
          <div class="form-inline footer template-placeholder"></div>
        </div>
      </div>
    </div>
  </script>

  <script id="view.list.th.group" type="text/ng-template">
    <th ng-show="dataSource.groups.length"></th>
  </script>

  <script id="view.list.td.group" type="text/ng-template">
    <td ng-show="dataSource.groups.length" class="group-header">
      <div ng-show="row._group">
        <span class="fa fa-fw fa-caret-right"
              ng-class="{'fa-caret-down': row._group.expanded, 'fa-caret-right': row._group.collapsed}"></span>
        ${::row._group.__str__} (${::row._group.count })
      </div>
    </td>
  </script>

  <script id="view.list.th.selector.jinja2" type="text/ng-template">
    <th class="list-record-selector">
        <input type="checkbox" class="dropdown-toggle" ng-click="action.selectToggle($event.currentTarget)" data-toggle="dropdown"
               onclick="$(this).closest('table').find('td.list-record-selector input').prop('checked', $(this).prop('checked'))">
    </th>
  </script>

  <script id="view.list.td.selector.jinja2" type="text/ng-template">
    <td class="list-record-selector" onclick="event.stopPropagation();">
      <input data-id="${ record.id }" type="checkbox" ng-click="action.selectToggle($event.currentTarget)"
             onclick="if (!$(this).prop('checked')) $(this).closest('table').find('th.list-record-selector input').prop('checked', false)">
    </td>
  </script>

</templates>


<templates>
  <script id="view.list.table.jinja2" type="text/ng-template">
    <table class="table table-hover dataTable">
      <thead>
      <tr>
        {% if options.rowSelector %}
          <th class="list-record-selector">
            <input type="checkbox" ng-click="action.selectToggle($event.currentTarget)"
                   onclick="$(this).closest('table').find('td.list-record-selector input').prop('checked', $(this).prop('checked'))">
          </th>
        {% endif %}
      </tr>
      </thead>
      <tbody>
      <tr ng-repeat="record in {{ records }}" ng-click="{{ rowClick }}">
        {% if options.rowSelector %}
          <td class="list-record-selector" ng-if="::!record.$hasChildren" onclick="event.stopPropagation()">
            <input type="checkbox" ng-click="action.selectToggle($event.currentTarget)" data-id="${ ::record.id }"
                   onclick="if (!$(this).prop('checked')) $(this).closest('table').find('th.list-record-selector input').prop('checked', false)">
          </td>
        {% endif %}
        <td class="row-group-header" ng-if="::record.$hasChildren" colspan="2">
          <i class="indent-${ ::record.$level }">&nbsp;</i>
		      <span class="fas fa-fw fa-caret-right" ng-class="{'fa-caret-down': record.$expanded, 'fa-caret-right': !record.$expanded}"></span>
          ${ record.__str__ } (${ record.count })
        </td>
      </tr>
      </tbody>
      <tfoot>
      <tr></tr>
      </tfoot>
    </table>
  </script>

  <script id="view.list.table.total.jinja2" type="text/ng-template">
    {% if field %}
      <td class="text-right font-weight-bold">
        <ng-total field="{{ field.name }}" expr="{{ total.total }}"></ng-total>
      </td>
    {% else %}
      <td class="borderless"></td>
    {% endif %}
  </script>

  <script id="view.list.table.delete.jinja2" type="text/ng-template">
    <th class="list-column-delete" ng-show="dataSource.parent.changing && !dataSource.readonly"></th>
    <td class="list-column-delete" ng-show="dataSource.parent.changing && !dataSource.readonly"
        ng-click="removeItem($index);$event.stopPropagation();">
      <i class="fa fa-trash"></i>
    </td>
  </script>
</templates>
